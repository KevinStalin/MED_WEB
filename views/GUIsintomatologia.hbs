{{> header }}
{{> headMed }}

<style type="text/css">
    body,
    html {

        height: 100%;
        background-repeat: no-repeat;
        background: url(assets/img/web3.jpg) no-repeat center center fixed;
        background-size: 100% 100%;
        opacity: 5;
        filter: alpha(opacity=1);
    }
</style>

   <body>
    <br><br><br><br><br><br><br>
    <br><br>

        <ol class="carousel-indicators" id="hero-carousel-indicators"></ol>

        <div class="carousel-inner" role="listbox">

            <!-- Slide 1 -->
                <center>
                    <div >
                        <h2><b>Sintomas</b></h2>
                    </div>
                    <div id="contentTabla">
                    <table class="egt" border="1">
                        <thead>
                        <tr>
                            <th>Tabla sintomatologia</th>
                        </tr>
                        </thead>
                        <tbody id="TB"></tbody>
                    </table>
                    </div>
                    <hr>
                    <div id="contenedor">
                        <div class="descripccion"> Sintomas selecionados </div>
                    </div>
                    <hr>
                    <br>
                    <div class="section-title">
                        <form id="create-form">
                            <h1>Ingrese sintoma</h1>
                            <!--<h2 name="id" value={{id_enfermedad}}> </h2>-->
                            <input type="text" name="descripcion" class="form-control" id="create-sintoma" placeholder="Sintoma"
                                data-rule="minlen:4" data-msg="Please enter at least 4 chars" />

                            <div class="validate"></div>
                            <br> <br>
                            <div class="text-center">
                            <button type="submit">Aceptar </button>
                            </div>
                        </form>
                    </div>
                    <div class="section-title">

                    </div>
                </center>

            </div>
        </div>
   
   </body>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script>
    //console.log('Hola como estas')
    $(function() {
        var id=[]
        $.ajax({
          url:'/consultaSintoma',
          contentType:'application/json',
          success:function(response){
                var tbodyEl=$('tbody');
                tbodyEl.html('');
                response.sintomas.forEach(function(sintoma){
                    tbodyEl.append('<tr><th id="'+sintoma._id+'0">'+sintoma.descripcion+'</th>\
                    <th><input visibility: hidden type="button" id="'+sintoma._id+'" value="'+sintoma.descripcion+'"></th></tr>');
                    $('#'+sintoma._id+'0').on('click',function(event){
                        event.preventDefault();
                        var ids=sintoma._id;
                        var valor=$('#'+sintoma._id+'').val();
                        id.push(ids); 
                        $('#contenedor').append('<div id="0'+sintoma._id+'" ><input visibility: hidden type="button" id="00'+sintoma._id+'" value="'+sintoma._id+'">'+valor+'</div>');
                    });
                    $('#contenedor').on('click','#0'+sintoma._id+'',function(){
                        var ll=$('#00'+sintoma._id+'').val();
                        console.log("ITEM: ",ll)
                        var i = id.indexOf(ll);
                        console.log("Indice: ",i);
                        id.splice( i, 1 );
                        var contiene=$('#0'+sintoma._id+'').remove();
                    });                   
                });
            }
        });
        

        $('#create-form').on('submit',function(event){
            event.preventDefault();
            var crear=$('#create-sintoma');

            $.ajax({
                url:'/sintomaIngresa',
                method:'POST',
                contentType:'application/json',
                data: JSON.stringify({ descripcion: crear.val() }),
                success: function(response){
                    console.log(response);
                    crear.val('');
                    //--
                    $.ajax({
                        url:'/consultaSintoma',
                        contentType:'application/json',
                        success:function(response){
                            var tbodyEl=$('tbody');
                            tbodyEl.html('');
                            response.sintomas.forEach(function(sintoma){
                                tbodyEl.append('<tr><th id="'+sintoma._id+'0">'+sintoma.descripcion+'</th>\
                                <th><input visibility: hidden type="button" id="'+sintoma._id+'" value="'+sintoma.descripcion+'"></th></tr>');
                                $('#'+sintoma._id+'0').on('click',function(event){
                                    event.preventDefault();
                                    var ids=sintoma._id;
                                    var valor=$('#'+sintoma._id+'').val();
                                    id.push(ids); 
                                    $('#contenedor').append('<div id="0'+sintoma._id+'" ><input visibility: hidden type="button" id="00'+sintoma._id+'" value="'+sintoma._id+'">'+valor+'</div>');
                                });
                                $('#contenedor').on('click','#0'+sintoma._id+'',function(){
                                    var ll=$('#00'+sintoma._id+'').val();
                                    console.log("ITEM: ",ll)
                                    var i = id.indexOf(ll);
                                    console.log("Indice: ",i);
                                    id.splice( i, 1 );
                                    var contiene=$('#0'+sintoma._id+'').remove();
                                });                   
                            });
                        }
                    });
                    //---
                }
            });

        });

        console.log("id_afuera",id)
});
    </script>


{{> footer }}