{{> header }}
{{> head }}

<body>
    <br><br><br><br><br><br><br>
    <br>
    <center>
        <div class="section-title">
            <h3> Enfermedad</h3>
        </div>
        <table class="egt" border="1">
            <thead>
            <tr>
                <th>Tabla enfermedad</th>
                <th>T</th>
            </tr>
            </thead>
            <tbody></tbody>
        </table>
        <br>
        <form id="create-form">
            <div class="col-md-6 mb-3">
                <label for="enfermedad">Ingrese enfermedad</label>            
                <input type="text" class="form-control" id="create-input" placeholder="" value="" required>
                
                <div class="invalid-feedback">
                    Valid last name is required.
                </div>
            </div>
            <br> 
            <div class="text-center">
                <button>Enviar</button>
            </div>
        </form>
        <br>
        <br>
    </center>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script>
    console.log('Hola como estas')
    $(function() {
        $.ajax({
          url:'/enfermedades',
          contentType:'application/json',
          success:function(response){
              console.log('REsponse.enfermedades');
              console.log(response.enfermedades);
              console.log('Respinse');
              console.log(response);              
              console.log('REsponse.enfermedades.leng');
                var tbodyEl=$('tbody');
                tbodyEl.html('');
                response.enfermedades.forEach(function(enfer){
                    let mensaje="";
                    mensaje+=""
                tbodyEl.append('<tr><th>'+enfer.descripcion+'</th><th ><a href="/sintomas/'+enfer._id+'">Seleccionar</a></th></tr>');
            });
          }
        });

        $('#create-form').on('submit',function(event){
            event.preventDefault();
            var crear=$('#create-input');

            $.ajax({
                url:'/enfermedades',
                method:'POST',
                contentType:'application/json',
                data: JSON.stringify({ descripcion: crear.val() }),
                success: function(response){
                    console.log(response);
                    crear.val('');
                    //--
                    $.ajax({
                        url:'/enfermedades',
                        contentType:'application/json',
                        success:function(response){
                            var tbodyEl=$('tbody');
                            tbodyEl.html('');
                            response.enfermedades.forEach(function(enfer){
                                tbodyEl.append('<tr><th>'+enfer.descripcion+'</th><th><a href="/sintoma/'+enfer._id+'">Seleccionar</a></th></tr>');
                            });
                        }
                    });

                }
            });
        });

    });
    //<th><a href="/sintoma/'+enfer._id+'>'+enfer._id+'</a></th>\
    //<th><button onclick="window.location.href=/sintoma/'+enfer._id+'">Seleccionar</button></th>
    //<th><a href="/sintoma/'+enfer._id+'">'+enfer._id+'</a></th>
    </script>
</body>
{{> footer }}