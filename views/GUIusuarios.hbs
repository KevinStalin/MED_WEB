{{> header }}
{{> head }}
<style type="text/css">
    .table-fixed tbody {
        height: 230px;
        overflow: auto;
        width: 100%;
    }

    .table-fixed thead,
    .table-fixed tbody,
    .table-fixed td,
    .table-fixed th {
        display: block;
    }

    .table-fixed tbody td,
    .table-fixed thead>tr>th {
        float: left;
        border-bottom-width: 0;
    }
</style>

<br><br><br><br><br><br><br>
<center>
    <h1>ADMINISTRADOR</h1>
</center>
<hr>
<h3 style="position: absolute; top: 255px; right:300px;">Buscar:</h3>
<form style="position: absolute; top: 260px; right:200px;">

    <select id="seleccion" name="genero">
        <option value="USER_MEDICO">MÃ©dico</option>
        <option value="USER_PACIENTE">Paciente</option>

    </select>
</form>
<br><br><br>

<div>
    <table id="usuarios" class="table table-hover table-fixed" border="3"
        style="width:100%" "position: absolute; top: 300px; left:20px;">
        <thead>
            <tr style="width: 680px">
                <th style="width: 250px" scope="col">id</th>
                <th style="width: 200px" scope="col">Nombre</th>
                <th style="width: 200px" scope="col">Apellido</th>
                <th style="width: 200px" scope="col">Cedula</th>
                <th style="width: 200px" scope="col">Correo Electronico</th>
                <th style="width: 200px" scope="col">Perfil</th>
                <th style="width: 200px" scope="col">Estado</th>
                <th style="width: 200px" scope="col">Actualizar</th>

            </tr>

        </thead>
        <tbody id="contenedor-us"> </tbody>
    </table>
</div>

<br><br><br><br><br><br><br><br><br>


<script src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
<script>

    $(function () {
        $.ajax({
            url: '/verusuarios',
            method: 'POST',
            contentType: 'application/json',
            success: function (response) {
                var tbodyEl = $('#contenedor-us');
                /// tbodyEl.html('');
                response.usuarios.forEach(function (usus) {
                    //tbodyEl.append('<tr><th>' + usus._id + '</th><th>' + usus.nombre + '</th><th>' + usus.apellido + ' </th><th>' + usus.cedula + '</th><th>' + usus.correo + '</th><th>' + usus.perfil + '</th><th>' + usus.estado + '</th><th><button id=' + usus._id + ' value=' + usus._id + '>Actualizar</button></th></tr>');
                    tbodyEl.append('<tr style="width: 680px" ><td style="width: 250px" scope="col">' + usus._id + '</td><td style="width: 200px" scope="col">' + usus.nombre + '</td><td style="width: 200px" scope="col">' + usus.apellido + ' </td><td style="width: 200px" scope="col">' + usus.identificacion + '</td><td style="width: 200px" scope="col">' + usus.correo + '</td><td style="width: 200px" scope="col">' + usus.perfil + '</td><td style="width: 200px" scope="col">' + usus.estado + '</td><td style="width: 200px" scope="col"><button id=' + usus._id + ' value=' + usus._id + '>Actualizar</button></td></tr>');
                    $("#" + usus._id + "").on('click', (event) => {
                        event.preventDefault();
                        console.log(usus._id, "####");
                        let estado = " ";
                        if (usus.estado == true) {
                            estado = false

                        } else {
                            estado = true
                        }
                        $.ajax({
                            url: '/elegirus/' + usus._id + '',
                            method: 'PUT',
                            contentType: 'application/json',
                            data: JSON.stringify({ estado: estado }),
                            success: function (response) {
                                console.log(response);
                                location.reload();
                            }
                        });
                    });

                });

            }
        });

        $("#seleccion").on('click', (event) => {
            event.preventDefault();
            var elegir = $('#seleccion');
            var tbodyEl = $('#contenedor-us');
            tbodyEl.html(' ');
            $.ajax({
                url: '/elegirus',
                method: 'POST',
                contentType: 'application/json',
                data: JSON.stringify({ opcion: elegir.val() }),
                success: function (response) {
                    var tbodyEl2 = $('#contenedor-us');
                    response.usuarios.forEach(function (usus) {

                        //tbodyEl2.append('<tr><th>' + usus._id + '</th><th>' + usus.nombre + '</th><th>' + usus.apellido + ' </th><th>' + usus.cedula + '</th><th>' + usus.correo + '</th><th>' + usus.perfil + '</th><th>' + usus.estado + '</th><th><button id=' + usus._id + ' value=' + usus._id + '>Actualizar</button></th></tr>');
                        tbodyEl2.append('<tr style="width: 680px" ><td style="width: 250px" scope="col">' + usus._id + '</td><td style="width: 200px" scope="col">' + usus.nombre + '</td><td style="width: 200px" scope="col">' + usus.apellido + ' </td><td style="width: 200px" scope="col">' + usus.identificacion + '</td><td style="width: 200px" scope="col">' + usus.correo + '</td><td style="width: 200px" scope="col">' + usus.perfil + '</td><td style="width: 200px" scope="col">' + usus.estado + '</td><td style="width: 200px" scope="col"><button id=' + usus._id + ' value=' + usus._id + '>Actualizar</button></td></tr>');

                        $("#" + usus._id + "").on('click', (event) => {
                            event.preventDefault();
                            console.log(usus._id, "####");
                            let estado = " ";
                            if (usus.estado == true) {
                                estado = false

                            } else {
                                estado = true
                            }
                            $.ajax({
                                url: '/elegirus/' + usus._id + '',
                                method: 'PUT',
                                contentType: 'application/json',
                                data: JSON.stringify({ estado: estado }),
                                success: function (response) {
                                    console.log(response);
                                    location.reload();
                                }
                            });
                        });
                    })

                }
            });
        });






    });
</script>
<br><br>
{{> footer }}